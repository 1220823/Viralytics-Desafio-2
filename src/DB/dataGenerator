import json
import random
from datetime import datetime, timedelta

num_campaigns_const = 10
num_ads_const = 40

def generate_campaigns_data(num_campaigns):
    campaigns = []
    
    ext_service_names = ['Facebook Ads', 'DV360', 'Google Ads']
    channel_names = ['Mobile', 'Social', 'Video', 'Display', 'Search']
    search_tag_cats = ['Youtube', 'Inmarket', 'Retargeting']
    
    campaign_names_base = [
        "Gut Health Revival", "Immune Boost Challenge", "Plant-Based Power", "Sugar-Free Lifestyle",
        "Mindful Eating Journey", "Wellness Warrior Program", "Hydration Heroes", "Nutrition Navigator",
        "Healthy Habits Kickstart", "Metabolism Reboot", "Clean Eating 30", "Peak Performance Protocol",
        "The Energy Reset", "Balanced Macros Masterclass", "Superfood Discovery", "Sleep & Recovery Science",
        "Heart Smart Initiative", "Fit Foodie Bootcamp"
    ]

    for i in range(1, num_campaigns + 1):
        name = random.choice(campaign_names_base) + f" {i:02d}"
        no_of_days = random.randint(1, 118)
        
        # Generate date within the last 6 months to next 6 months
        start_date = datetime.now() + timedelta(days=random.randint(-180, 180))
        time_str = start_date.strftime('%Y-%m-%d')
        
        approved_budget = round(random.uniform(400.0, 6000000.0), 2)
        impressions = random.randint(511, 153959)
        clicks = random.randint(2, 31807)
        media_cost_usd = round(random.uniform(0.0, 2295.028945), 2)
        
        campaign = {
            "id": i,
            "name": name,
            "no_of_days": no_of_days,
            "time": time_str,
            "approved_budget": approved_budget,
            "impressions": impressions,
            "clicks": clicks,
            "media_cost_usd": media_cost_usd,
            "ext_service_name": random.choice(ext_service_names),
            "channel_name": random.choice(channel_names),
            "search_tag_cat": random.choice(search_tag_cats),
            "overcost": 0
        }
        campaigns.append(campaign)
    return campaigns

def generate_ads_data(num_ads):
    ads = []
    
    age_groups = ['18-24', '25-34', '35-44', '45-54', '55+']
    engagement_levels = ['Ignored', 'Liked', 'Commented', 'Shared', 'Viewed']
    device_types = ['Tablet', 'Desktop', 'Mobile']
    locations = ['UK', 'Germany', 'India', 'USA', 'Canada']
    genders = ['Male', 'Female']
    content_types = ['Image', 'Text', 'Video']
    ad_topics = ['Health'] # Focused on Health topic
    ad_target_audiences = [
        'Young Adults', 'Family Oriented', 'Fitness Lovers' # Focused on Health topic
    ]

    ad_names_base = [
        "Transform Your Gut with Probiotics!", "Boost Immunity Naturally", "Discover Delicious Plant-Based Meals",
        "Say Goodbye to Sugar Cravings", "Mindful Bites for a Better You", "Unlock Your Inner Wellness",
        "Stay Hydrated, Stay Healthy", "Organic Superfoods for Energy", "Lose Weight the Healthy Way",
        "Fuel Your Body with Nutrients", "Eat Clean, Feel Great!", "Your Daily Dose of Vitamins",
        "Personalized Nutrition Plans", "Achieve Your Fitness Goals", "Sleep Better, Live Better",
        "Revitalize Your Metabolism", "Nourish Your Body From Within", "The Secret to All-Day Energy",
        "Radiate Health and Glow", "Balance Your Hormones Naturally", "Holistic Healing Through Food",
        "Detox Your Diet Safely", "Power Up With Lean Protein", "Heart-Healthy Omega-3s",
        "Gluten-Free Goodness", "Keto-Friendly Snack Ideas", "Fiber-Rich Foods for Digestion",
        "Antioxidants for Anti-Aging", "Essential Minerals You Need", "Healthy Fats for Brain Power",
        "Master Your Weekly Meal Prep", "Smart Snacking Solutions", "Beat the Afternoon Slump",
        "Post-Workout Recovery Fuel", "Simple Swaps for Better Health", "Crush Your Carb Cravings",
        "Eating for Mental Clarity"
    ]

    for i in range(1, num_ads + 1):
        name = random.choice(ad_names_base)
        click_through_rate = round(random.uniform(0.02, 0.2), 6) 
        view_time = random.randint(5, 90) 
        cost_per_click = round(random.uniform(0.2, 2.0), 2)
        roi = round(random.uniform(-0.5, 30), 2)
        
        # Generate timestamp within the last 6 months and next 6 months
        start_date = datetime.now() + timedelta(days=random.randint(-180, 180))
        timestamp_str = start_date.strftime('%Y-%m-%d %H:%M:%S')
        
        ad = {
            "id": i,
            "name": name,
            "click_through_rate": click_through_rate,
            "view_time": view_time,
            "cost_per_click": cost_per_click,
            "roi": roi,
            "timestamp": timestamp_str,
            "age_group": random.choice(age_groups),
            "engagement_level": random.choice(engagement_levels),
            "device_type": random.choice(device_types),
            "location": random.choice(locations),
            "gender": random.choice(genders),
            "content_type": random.choice(content_types),
            "ad_topic": random.choice(ad_topics), # Will always be 'Health'
            "ad_target_audience": random.choice(ad_target_audiences),
            "conversion_rate": 0 
        }
        ads.append(ad)
    return ads

# Generate data
campaigns_data = generate_campaigns_data(num_campaigns_const) 
ads_data = generate_ads_data(num_ads_const)

# Save to JSON files
with open('src/DB/campaigns.json', 'w') as f:
    json.dump(campaigns_data, f, indent=4)

with open('src/DB/ads.json', 'w') as f:
    json.dump(ads_data, f, indent=4)

print("Generated campaigns.json and ads.json successfully!")
print(f"Number of campaigns generated: {len(campaigns_data)}")
print(f"Number of ads generated: {len(ads_data)}")